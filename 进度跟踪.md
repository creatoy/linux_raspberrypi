# 进度跟踪

## 20240803

### 目前已完成的工作

1. 封装了 ClkHw 结构和 ClkOps 特征，用于 i2c 驱动完成中的时钟管理功能，代码主要集中在文件 [rust/kernel/clk_provider.rs](rust/kernel/clk_provider.rs) 中
2. 将 6.1 内核中 module 宏的 params 字段添加回来，用于添加 i2c 驱动模块的相关参数，代码主要在文件 [rust/macros/module_param.rs](rust/macros/module_param.rs) [rust/macros/helpers.rs](rust/macros/helpers.rs) 和 [rust/macros/module.rs](rust/macros/module.rs) 中
3. 将 c 版本 i2c 驱动代码翻译成 Rust 版本，代码主要集中在 [drivers/i2c/busses/i2c_bcm2835_rust.rs](drivers/i2c/busses/i2c_bcm2835_rust.rs) 中

- 其中前两项工作已全部完成，第三项工作还在进行中：其中 bcm2835_i2c_register_div 的实现基本完成，下一步主要是实现 bcm2835_i2c_probe 函数中的内容，以及完成驱动框架的整体流程，让驱动模块真正能运行起来。

### 接下来可做的工作

1. 使用 module_platform_driver 宏来注册 i2c 驱动模块（现在使用的是 module 宏，但根据老师的建议应该使用前者），并让 i2c 驱动模块能运行起来（不需要真正实现功能，只需要在关键函数中打印一些信息即可）
2. 完成 i2c_algorithm 在 rust 下的实现，可以参考 ClkOps 和 UartPortOps 的实现
3. 完成 i2c_adapter 在 rust 下的实现
4. 完成 i2c_msg 在 rust 下的实现
5. 完成 bcm2835_i2c_probe 函数的实现（依赖前几项工作）
